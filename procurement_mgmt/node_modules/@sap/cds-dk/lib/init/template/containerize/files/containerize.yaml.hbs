---
_schema-version: '1.0'
repository: {{& imageRegistry}}
tag: latest
{{#hasHelmUnifiedRuntime}}
{{#isJava}}
before-all:
  - helm dependency update ./gen/chart
  - mvn clean package -DskipTests=true --batch-mode
{{/isJava}}
{{/hasHelmUnifiedRuntime}}
{{^hasJava}}
{{#hasHelmUnifiedRuntime}}
before-all:
  - helm dependency update ./gen/chart
{{/hasHelmUnifiedRuntime}}
{{/hasJava}}
{{^hasHelmUnifiedRuntime}}
{{#hasJava}}
before-all:
  - mvn clean package -DskipTests=true --batch-mode
{{/hasJava}}
{{/hasHelmUnifiedRuntime}}
modules:
  - name: {{appName}}-srv
    build-parameters:
      buildpack:
        {{#hasHelmUnifiedRuntime}}
        builder: proxy-unified-runtime-dmz.int.repositories.cloud.sap/builder/noble
        {{/hasHelmUnifiedRuntime}}
        {{^hasHelmUnifiedRuntime}}
        {{#isNodejs}}
        type: nodejs
        {{/isNodejs}}
        builder: builder-jammy-base
        {{/hasHelmUnifiedRuntime}}
        path: {{#isNodejs}}gen/srv{{/isNodejs}}{{#isJava}}srv/target/{{appName}}-exec.jar{{/isJava}}
        env:
        {{#isNodejs}}
          BP_NODE_RUN_SCRIPTS: ""
        {{/isNodejs}}
        {{#isJava}}
          SPRING_PROFILES_ACTIVE: cloud
          BP_JVM_VERSION: 21
        {{/isJava}}
